class Solution {

    class UnionBySize{
    int[] size;
    int[] parent;
    UnionBySize(int n) {
        size = new int[n+1];
        parent = new int[n+1];
        for (int i = 0; i <= n; i++) {
            size[i] = 1;
            parent[i] = i;
        }
    }

    public int find(int node){
        if (node == parent[node]) return node;
        return parent[node] = find(parent[node]);
    }

    public void union(int u, int v){
        int par_u = find(u);
        int par_v = find(v);
        if (par_u == par_v) {
            return;
        }
        if (size[par_u] < size[par_v]) {
            parent[par_u] = par_v;
            size[par_v] +=size[par_u];
        }
        else{
            parent[par_v] = par_u;
            size[par_u] += size[par_v];
        }
    }
}
    public int removeStones(int[][] stones) {
        int maxRow = 0, maxCol = 0;
        for (int i = 0; i < stones.length; i++){
            maxRow = Math.max(maxRow, stones[i][0]);
            maxCol = Math.max(maxCol, stones[i][1]);
        }
        UnionBySize dsu = new UnionBySize(maxRow + maxCol + 1);
        Set<Integer> hs = new HashSet<>();
        for(int i = 0; i < stones.length; i++) {
            int row = stones[i][0];
            int col = stones[i][1] + maxRow + 1;
            dsu.union(row, col);
            hs.add(row);
            hs.add(col);
        }
        int ultPar = 0;
        for(int num : hs){
            if(dsu.find(num) == num) {
                ultPar++;
            }
        }
        return stones.length - ultPar;
    }
}
