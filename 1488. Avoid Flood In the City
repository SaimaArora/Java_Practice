class Solution {
    public int[] avoidFlood(int[] rains) {
        int n = rains.length;
        int[] ans = new int[n];
        Arrays.fill(ans, -1);
        HashMap<Integer,Integer> fullLakes = new HashMap<>();
        TreeSet<Integer> dryLakes = new TreeSet<>();
        for(int i = 0; i < n; i++) {
            int lake = rains[i];
            if (lake == 0) dryLakes.add(i);
            else{
                ans[i] = -1;
                if(fullLakes.containsKey(lake)){
                    int index = fullLakes.get(lake);
                    int nextdry = dryLakes.higher(index) == null ? -1 : dryLakes.higher(index);
                    if(nextdry == -1) return new int[]{};
                    dryLakes.remove(nextdry);
                    ans[nextdry] = lake; 
                }
                fullLakes.put(lake, i);
            }
        }
        for(int ind : dryLakes) {
            ans[ind] = 1;
        }
        return ans;
    }
}
