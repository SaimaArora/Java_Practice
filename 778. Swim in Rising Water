class Solution {
    class DSU{
        int[] size;
        int[] parent;
        DSU(int n) {
            size = new int[n+1];
            parent = new int[n+1];
            for (int i = 0; i <= n; i++) {
                size[i] = 1;
                parent[i] = i;
            }
        }

        public int find(int node){
            if (node == parent[node]) return node;
            return parent[node] = find(parent[node]);
        }

        public void union(int u, int v){
            int par_u = find(u);
            int par_v = find(v);
            if (par_u == par_v) {
                return;
            }
            if (size[par_u] < size[par_v]) {
                parent[par_u] = par_v;
                size[par_v] +=size[par_u];
            }
            else{
                parent[par_v] = par_u;
                size[par_u] += size[par_v];
            }
        }
    }
    class Node{
        int u, v, wt;
        Node(int u, int v, int wt) {
            this.u = u;
            this.v = v;
            this.wt = wt;
        }
    }
    public int swimInWater(int[][] grid) {
        int n = grid.length;
        int[] rows = new int[]{1, 0};
        int[] cols = new int[]{0, 1};
        List<Node> edges = new ArrayList<>();

        for (int i = 0; i < grid.length; i++) {
            for (int j = 0; j < grid.length; j++) {
                int e = i*n + j;
                for(int dir = 0; dir < 2; dir++) {
                    int nr = rows[dir] + i, nc = cols[dir] + j;
                    if (nr < n && nc < n) {
                        int nwt = Math.max(grid[i][j], grid[nr][nc]), ne = nr*n + nc;
                        edges.add(new Node(e, ne, nwt));
                    }
                }
            }
        }
        Collections.sort(edges, (a, b)-> {
            return a.wt - b.wt;
        });
        DSU dsu = new DSU(n*n);
        int count = 0, start = 0, end = n*n - 1;
        for(Node node : edges) {
            if(dsu.find(node.u) != dsu.find(node.v)) {
                dsu.union(node.u, node.v);
                if (dsu.find(start) == dsu.find(end)) {
                    return node.wt;
                }
            }
        }
        return 0;
    }
}
