class Solution {

    public class Word{
        int level;
        String word;
        Word(String str, int l) {
            level = l;
            word = str;
        }
    }
    public int ladderLength(String begin, String end, List<String> list, HashMap<String, Integer> hs) {
        Queue<Word> q = new LinkedList<>();
        Set<String> dict = new HashSet<>();
        for(String str : list) dict.add(str);
        q.offer(new Word(begin, 1));
        hs.put(begin, 1);
        dict.remove(begin);
        while(!q.isEmpty()) {
            Word curr = q.poll();
            String w = curr.word;
            if(w.equals(end)) return curr.level;
            for (int i = 0; i < w.length(); i++) {
                for (char c = 'a'; c <='z'; c++) {
                    char[] arr = w.toCharArray();
                    arr[i] = c;
                    String newWord = new String(arr);
                    
                    if(dict.contains(newWord)) {
                        q.offer(new Word(newWord, curr.level+1));
                        hs.put(newWord, curr.level + 1);
                        dict.remove(newWord);
                    }
                }
            }
        }
        return 0;
    }

    public void dfs(String word, String begin, List<String> list, HashMap<String, Integer> hs, List<List<String>> ans) {
        if (word.equals(begin)) {
            List<String> copy = new ArrayList<>(list);
            Collections.reverse(copy);
            ans.add(copy);
            return;
        }
        for(int i = 0 ; i < word.length(); i++) {
            for(char ch = 'a'; ch <= 'z'; ch++) {
                char[] arr = word.toCharArray();
                arr[i] = ch;
                String newWord = new String(arr);
                if(hs.containsKey(newWord) && hs.get(word)-1 == hs.get(newWord)) {
                    list.add(newWord);
                    dfs(newWord, begin, list, hs, ans);
                    list.remove(list.size() - 1);
                }
            }
        }

    }

    public List<List<String>> findLadders(String begin, String end, List<String> list) {
        HashMap<String, Integer> hs = new HashMap<>();
        int length = ladderLength(begin, end, list, hs);
        List<List<String>> ans = new ArrayList<>();
        if(!hs.containsKey(end)) return ans;
        List<String> l = new ArrayList<>();
        l.add(end);
        dfs(end, begin, l, hs, ans);
        return ans;
    }
}
