class Solution {
    private void generateSums(int curr, int limit, int sum, int count, int total, List<Integer>[] map, int[] nums) {
        if(count > total) return;
        if(curr == limit) {
            map[count].add(sum);
            return;
        }
        generateSums(curr+1, limit, sum + nums[curr], count+1, total, map, nums);
        generateSums(curr+1, limit, sum, count, total, map, nums);
    }
    public int minimumDifference(int[] nums) {
        int total = 0, n = nums.length / 2 ;
        for(int num : nums) total+= num;
        List<Integer>[] left = new ArrayList[n + 1];
        List<Integer>[] right = new ArrayList[n + 1];
        for(int i = 0; i < n+1; i++) {
            left[i] = new ArrayList<>();
            right[i] = new ArrayList<>();
        }
        generateSums(0, n, 0, 0, n, left, nums);
        generateSums(n, nums.length, 0, 0, n, right, nums);
        int minDiff = Integer.MAX_VALUE;
        int target = total / 2;
        for(int i = 0; i < left.length; i++) {
            int r = n - i;
            TreeSet<Integer> rightSet = new TreeSet<>(right[r]);
            for(int sumLeft : left[i]) {
                int needed = target - sumLeft;
                Integer small = rightSet.floor(needed);
                Integer large = rightSet.ceiling(needed);
                if(small != null) {
                    minDiff = Math.min(minDiff, Math.abs(total - 2 * (small + sumLeft)));
                }
                if (large != null) {
                    minDiff = Math.min(minDiff, Math.abs(total - 2 * (large + sumLeft)));
                }
            }
        }
        return minDiff;
    }
}
