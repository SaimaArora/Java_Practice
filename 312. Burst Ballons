class Solution {

    public int recursion(int i, int j, int[] nums, int[][] memo) {
        if(i + 1 == j) return 0;
        if(memo[i][j] != -1) return memo[i][j];
        int max = 0;
        for(int k = i+1; k < j; k++) {
            int l = recursion(i, k, nums, memo);
            int r = recursion(k, j,  nums, memo);
            int total = nums[k]*nums[i]*nums[j] + l+r;
            max = Math.max(max, total);
        }
        return memo[i][j] = max;
    }
    public int maxCoins(int[] nums) {
        int n = nums.length;
        int[][] memo = new int[n+2][n+2];
        for(int[] i : memo) Arrays.fill(i, -1);
        int[] arr = new int[nums.length+2];
        arr[0] = 1;
        int i = 1;
        for(int ind = 0; ind < nums.length; ind++) {
            arr[i++] = nums[ind];
        }
        arr[i] = 1;
        return recursion(0, n+1, arr, memo);
    }
}
